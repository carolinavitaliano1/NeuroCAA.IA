<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>ðŸ§  Prancha Compartilhada</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="stylesheet" href="css/style.css" />

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f8fafc;
      margin: 0;
      padding: 20px;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
    .board {
      display: grid;
      gap: 12px;
      justify-content: center;
    }
    .cell {
      border: 2px solid #334155;
      border-radius: 8px;
      padding: 8px;
      text-align: center;
      background: white;
      width: 120px;
    }
    .cell img {
      max-width: 100%;
      height: auto;
    }
    .cell span {
      display: block;
      margin-top: 6px;
      font-weight: bold;
    }
    .error {
      text-align: center;
      color: #b91c1c;
      font-weight: bold;
    }
  </style>
</head>

<body>
  <h1>ðŸ§  Prancha Compartilhada</h1>
  <div id="status" class="error"></div>
  <div id="board" class="board"></div>

  <!-- ðŸ”¥ FIREBASE COMPAT -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDPwPgsjw0bUrwfvt7242MGEekOdKuT1_8",
      authDomain: "neurocaa-1460e.firebaseapp.com",
      projectId: "neurocaa-1460e",
      databaseURL: "https://neurocaa-1460e-default-rtdb.firebaseio.com",
      appId: "1:788969719580:web:fce897a25a2f46dcdadcd9"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

 <script>
    
  // ðŸ”Ž pega o ID da URL
  const params = new URLSearchParams(window.location.search);
  const shareId = params.get("share");

  const statusEl = document.getElementById("status");
  const boardEl  = document.getElementById("board");

  if (!shareId) {
    statusEl.innerText = "âš ï¸ Link invÃ¡lido ou incompleto.";
    throw new Error("share ausente");
  }

  // ðŸ”¥ busca no Firebase
  firebase
    .database()
    .ref("sharedBoards/" + shareId)
    .once("value")
    .then(snapshot => {
      if (!snapshot.exists()) {
        statusEl.innerText = "âš ï¸ Prancha nÃ£o encontrada.";
        return;
      }

      const data = snapshot.val();

      // ðŸ›‘ VALIDAÃ‡ÃƒO CRÃTICA (essa que vocÃª perguntou!)
      if (!data.board || !Array.isArray(data.board)) {
        statusEl.innerText = "âš ï¸ Prancha invÃ¡lida ou vazia.";
        return;
      }

      statusEl.innerText = "";

      // ðŸ§© renderiza a prancha
      renderSharedBoard(data);
    })
    .catch(err => {
      console.error(err);
      statusEl.innerText = "Erro ao carregar a prancha.";
    });

  // =========================
  // ðŸ§© RENDERIZAÃ‡ÃƒO
  // =========================
  function renderSharedBoard(data) {
    boardEl.innerHTML = "";

    data.board.forEach(cell => {
      const div = document.createElement("div");
      div.className = "cell";

      if (cell.image) {
        const img = document.createElement("img");
        img.src = cell.image;
        img.alt = cell.text || "";
        div.appendChild(img);
      }

      if (cell.text) {
        const p = document.createElement("p");
        p.innerText = cell.text;
        div.appendChild(p);
      }

      boardEl.appendChild(div);
    });
  }
</script>
</body>
</html>
